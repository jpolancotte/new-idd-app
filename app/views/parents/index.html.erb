<p style="color: green"><%= notice %></p>

<div class="container table-responsive">
  <h1>Parents </h1>  
  <table class="table table-striped table-hover table-sm">
    <thead>
      <tr>        
        <th scope="col">Company Name</th>
        <th scope="col">NPI Locations</th>
        <th scope="col">State(s)</th>
      </tr>
    </thead>
    <tbody>
      <% @parents.each do |parent| %>   
        <% a = NpiCompany.where(parent_id: parent.id).where.not(state_id: nil) %> 
        <% b = a.pluck(:state_id).uniq %>        
                         
      <tr>       
        <td><%= link_to parent.name, parent %></td>
        <td><span class="badge bg-primary rounded-pill"><%= parent.npi_companies.size %></span></td>
        <% if b.size > 1 %> 
         <% b.each do |s| %> 
          <td><%= State.find(s).iso %></td>
         <% end %>
        <% elsif b.size == 1%>
         <td><%= State.find(b.first).iso %> </td>
        <% elsif b.size == 0%>
        <td><% b.size %> </td>
        <% end %>
      </tr>       
      <% end %>     
    </tbody>
  </table>
</div>





<% link_to "New parent", new_parent_path %>
